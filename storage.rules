// üîê Regras de Seguran√ßa do Firebase Storage
// Copie e cole estas regras no Firebase Console > Storage > Regras

rules_version = '2';
service firebase.storage {
  match /b/{bucket}/o {
    
    // ==========================================
    // FOTOS DE ATLETAS
    // ==========================================
    match /athletes/{athleteId}/{allPaths=**} {
      // Permite leitura para todos
      allow read: if true;
      
      // Permite upload para todos (ajuste conforme necessidade)
      allow write: if true;
      
      // Valida√ß√µes de arquivo
      // allow create, update: if request.resource.size < 5 * 1024 * 1024  // M√°ximo 5MB
      //                       && request.resource.contentType.matches('image/.*');  // Apenas imagens
      
      // TODO: Adicionar autentica√ß√£o
      // allow write: if request.auth != null;
    }
    
    // ==========================================
    // LOGOS DE TEMPORADAS
    // ==========================================
    match /seasons/{seasonId}/{allPaths=**} {
      // Permite leitura para todos
      allow read: if true;
      
      // Permite upload para todos (ajuste conforme necessidade)
      allow write: if true;
      
      // Valida√ß√µes de arquivo
      // allow create, update: if request.resource.size < 2 * 1024 * 1024  // M√°ximo 2MB
      //                       && request.resource.contentType.matches('image/.*');  // Apenas imagens
      
      // TODO: Adicionar autentica√ß√£o
      // allow write: if request.auth != null;
    }
  }
}

// ==========================================
// VERS√ÉO COM AUTENTICA√á√ÉO E VALIDA√á√ïES (FUTURA IMPLEMENTA√á√ÉO)
// ==========================================
// Descomente e ajuste quando implementar autentica√ß√£o

/*
rules_version = '2';
service firebase.storage {
  match /b/{bucket}/o {
    
    // Fun√ß√£o helper para validar tamanho de imagem
    function validImageSize(maxSizeMB) {
      return request.resource.size < maxSizeMB * 1024 * 1024;
    }
    
    // Fun√ß√£o helper para validar tipo de arquivo
    function isImage() {
      return request.resource.contentType.matches('image/.*');
    }
    
    // Fun√ß√£o helper para verificar autentica√ß√£o
    function isAuthenticated() {
      return request.auth != null;
    }
    
    // Fun√ß√£o helper para verificar se √© admin
    function isAdmin() {
      return request.auth != null && 
             firestore.exists(/databases/(default)/documents/admins/$(request.auth.uid));
    }
    
    // FOTOS DE ATLETAS
    match /athletes/{athleteId}/{allPaths=**} {
      allow read: if true;
      allow write: if isAuthenticated() 
                   && isImage() 
                   && validImageSize(5);  // M√°ximo 5MB
    }
    
    // LOGOS DE TEMPORADAS
    match /seasons/{seasonId}/{allPaths=**} {
      allow read: if true;
      allow write: if isAdmin() 
                   && isImage() 
                   && validImageSize(2);  // M√°ximo 2MB
    }
  }
}
*/
